<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='UTF-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1.0'>
        <title>Scene Demo</title>
        <script src="scripts/phaser.min.js"></script>
        <script src="scripts/main.js"></script>
        <script src="scripts/MovementTest.js"></script>
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
      <script type='text/javascript'>

              var config = {
                  type: Phaser.AUTO,
                  width: 800,
                  height: 600,
                  physics: {
                      default: 'arcade',
                      arcade: {
                          gravity: { y: 400},
                          debug: false
                      }
                  },
                  scene: [TitleScene, GameScene]
              };

              var player;
              var platforms;
              var checkpoint;
              var cursors;
              var portal;
              var canGrab;
              var rotated;
              var wallJumped;
              var bodyTouchingLeft;
              var mover;
              var isOnWall;
              var isOnLeft;
              var isOnRight;

              var game = new Phaser.Game(config);

               function stickmechanic(){
                   //gets how long the object is held for
                   var held = cursors.space.getDuration();
                   console.log(held);
                   //checks if  player is on a wall
                   if (isOnWall){
                        canGrab = true;
                        if (isOnRight){
                            //rotates player right
                            player.angle = 270;
                            rotated = true;
                            bodyTouchingLeft = false;
                        }
                        else {
                            //rotates player left
                            player.angle = 90;
                             rotated = true;
                            bodyTouchingLeft = true;
                        }
                    }
                   
                   if (held < 3000 && cursors.space.isDown && canGrab == true){
                       //turns off the gravity and allows the player to stick in place
                       player.body.setAllowGravity(false);
                       console.log(held);
                       player.setVelocityY(0);
                       //once the player presses up he can't grab the wall again and he has an upward jump
                       if (cursors.up.isDown){
                           player.body.setAllowGravity(true);
                           player.body.setVelocityY(-320);
                           canGrab = false;
                           //prevents player from sliding
                           wallJumped = true;
                           //allows player to move left or right upon jumping
                           isOnLeft = false;
                           isOnRight = false;
                           isOnWall = false;
                       }
                   }
                   //resets player gravity once they stick for too long
                   else{
                       player.body.setAllowGravity(true);
                       canGrab = false;
                       bodyTouchingLeft = null;
                   }
                   }
               function stickmechanicMoving(){
                    //gets how long the object is held for
                    var held = cursors.space.getDuration();
                    console.log(held);
                    if (isOnRight){
                            //rotates player right
                            player.angle = 270;
                            rotated = true;
                            canGrab = true;
                        }
                        else {
                            //rotates player left
                            player.angle = 90;
                            rotated = true;
                            canGrab = true;
                        }
                    if (held < 3000 && cursors.space.isDown && canGrab == true){
                       //turns off the gravity and allows the player to stick in place
                       player.body.setAllowGravity(false);
                       console.log(held);
                       player.setVelocityY(0);
                       player.y = mover.y;
                       //once the player presses up he can't grab the wall again and he has an upward jump
                       if (cursors.up.isDown){
                           player.body.setAllowGravity(true);
                           player.body.setVelocityY(-320);
                           canGrab = false;
                           wallJumped = true;
                           //allows player to move left or right upon jumping
                           isOnLeft = false;
                           isOnRight = false;
                           isOnWall = false;
                       }
                   }
                   //resets player gravity once they stick for too long
                   else{
                       player.body.setAllowGravity(true);
                       canGrab = false;
                   }
          }
          
              </script>
    </body>
</html>
